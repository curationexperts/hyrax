<h4 class="text-center"><%= @start_date.to_date.strftime("%B %d, %Y") %> through <%= @end_date.to_date.strftime("%B %d, %Y") %></h4>

<h4>Summary of user activity</h4>
<hr />

<table class="table table-striped">
  <thead>
  <tr>
    <th>&nbsp;</th>
    <th>Date Range</th>
    <th>Today</th>
    <th>This week</th>
    <th>This month</th>
    <th>This year</th>
    <th>All time</th>
  </tr>
  </thead>
  <tbody>
    <tr>
      <td><b>Downloads</b></td>
      <td><%= Hyrax::Analytics.works_downloads("range", "#{@start_date},#{@end_date}").count %></td>
      <td><%= Hyrax::Analytics.works_downloads("day").count %></td>
      <td><%= Hyrax::Analytics.works_downloads("week").count %></td>
      <td><%= Hyrax::Analytics.works_downloads("month").count %></td>
      <td><%= Hyrax::Analytics.works_downloads("year").count %></td>
      <td><%= Hyrax::Analytics.works_downloads("range", "#{Time.zone.today-10.years},#{Time.zone.today}").count %></td>
    </tr>
    <tr>
      <td><b>Page Views</b></td>
      <td><%= Hyrax::Analytics.works_pageviews("range", "#{@start_date},#{@end_date}") %></td>
      <td><%= Hyrax::Analytics.works_pageviews("day") %></td>
      <td><%= Hyrax::Analytics.works_pageviews("week") %></td>
      <td><%= Hyrax::Analytics.works_pageviews("month") %></td>
      <td><%= Hyrax::Analytics.works_pageviews("year") %></td>
      <td><%= Hyrax::Analytics.works_pageviews("range", "#{Time.zone.today-10.years},#{Time.zone.today}") %></td>
    </tr>

  </tbody>
</table>

<h4>Works</h4>
<hr />

<table class="table table-striped">
  <thead>
  <tr>
    <th>Work Title</th>
    <th>Views</th>
  </tr>
  </thead>
  <tbody>
  <% if @works.any? %>
    <% @works.each do |work| %>
    <tr>
      <td><%= work.try(:pageTitle) %></td>
      <td><%= work.try(:pageviews) %></td>

    </tr>
    <% end %>
  <% end %>
  </tbody>
</table>

<h4>Files</h4>
<hr />

<table class="table table-striped">
  <thead>
  <tr>
    <th>File Name</th>
    <th>Downloads</th>
  </tr>
  </thead>
  <tbody>
  <% if @downloads.any? %>
    <% @downloads.each do |download| %>
    <tr>
      <td><% file = FileSet.find(download[:eventLabel]) %> <%= file %></td>
      <td><%= download.try(:totalEvents) %></td>
    </tr>
    <% end %>
  <% end %>
  </tbody>
</table>